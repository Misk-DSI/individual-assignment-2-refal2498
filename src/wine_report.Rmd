---
title: "wine_report"
output: html_document
date: '2022-06-15'
---

knit: (function(input, ...) {
    rmarkdown::render(
      input,
      output_dir = "../"
    )
  })

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


## Data set informattion 
we are going to preform the Exploratory Data Analysis techniques on  the Red wine data set.

Attribute Information:
The Variables are :
1 - fixed acidity
2 - volatile acidity
3 - citric acid
4 - residual sugar
5 - chlorides
6 - free sulfur dioxide
7 - total sulfur dioxide
8 - density
9 - pH
10 - sulphates
11 - alcohol
12 - quality


####Import libraries and load dataset

```{r}
#Import libraries 

install.packages('memisc')
install.packages('ggplot2')
install.packages('gridExtra')
install.packages("RColorBrewer")
install.packages("psych")


library(gridExtra)
library(grid)
library(dplyr)
library(GGally)
library(scales)
library(ggpubr)
library(tidyverse)
library(readxl)
library(factoextra)
library(ggplot2)
library(corrplot)
library(factoextra)
library(tidyr)
library(nnet)
library(rpart)
library(janitor)
library(here)
library(kableExtra)
#load dataset using here package 

#Uploading the data
red_wine<-read.csv(here("data/winequality-red.csv"))
fixed.acidity<-read.csv(here("data/winequality-red.csv"))
alcohol<-read.csv(here("data/winequality-red.csv"))
rating<-read.csv(here("data/winequality-red.csv"))
citric.acid<-read.csv(here("data/winequality-red.csv"))
volatile.acidity<-read.csv(here("data/winequality-red.csv"))
residual.sugar<-read.csv(here("data/winequality-red.csv"))
chlorides<-read.csv(here("data/winequality-red.csv"))
free.sulfur.dioxide<-read.csv(here("data/winequality-red.csv"))
density<-read.csv(here("data/winequality-red.csv"))
total.sulfur.dioxide<-read.csv(here("data/winequality-red.csv"))
pH<-read.csv(here("data/winequality-red.csv"))
sulphates<-read.csv(here("data/winequality-red.csv"))
quality<-read.csv(here("data/winequality-red.csv"))


```
 
####Display the data 

```{r}
knitr::kable(head(red_wine[, 1:12]), "pipe")

```

####Cleaning the data set names 
we are going to use clean_names() function from the janitor package. 

```{r}
#cleaning the data set names 
 red_wine <-clean_names(red_wine)
 head(red_wine)
```

After we clean the data set,Lets have a look at the data set dimensions and Let us check the data types of each attribute.


```{r}

# List red_wine data set column names, types and a subset of values

str_redwine <- str(red_wine)
str_redwine %>%
  kbl() %>%
  kable_material(c("striped", "hover"))

# Find dimensions of red_wine data set
dim(red_wine)

```

We can observe that all the variables are numerical except the quality which is integer variable.And data set has 1599 values with 13 variables.

Now,we will add a variable (rating)  to the data set to categorize the quality of the wine into Bad,Average and Good corresponding to the values up to 4, 5 to 7 and 8 and above.

```{r}

#Creating a new Variable called 'Rating'

red_wine$rating <- ifelse(red_wine$quality < 5, 'bad', ifelse(
  red_wine$quality < 7, 'average', 'good'))
red_wine$rating <- ordered(red_wine$rating,
                           levels = c('bad', 'average', 'good'))

# Display summary statistics for each variable
redwine_summ <- summary(red_wine)

redwine_summ %>%
  kbl() %>%
  kable_material(c("striped", "hover"))

```

```{r}
#Transforming quality from an Integer to a Factor
red_wine$quality <- factor(red_wine$quality, ordered = T)

# Check how many missing values are in each column/variable
#and sum them up per column

colSums(is.na(red_wine))
 
```
We can see that their is no missing values.

```{r}
#display only the variables that has a 10 or greater of alcohol 
alcohol10 <- red_wine[red_wine$alcohol >= 10, ]
alcohol10

```
From the 1599 rows it shows that 919 rows are 10 or greater.

## EDA

this part will show the data visualization for each variable the statistical summary is concluded. 


```{r}
# Distribution of fixed acidity variable

summary(red_wine$fixed.acidity)

fixed_acidity_h <-ggplot(aes(x=fixed.acidity,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of citric acid variable

summary(red_wine$citric.acid)

citric_acid_h <-ggplot(aes(x=citric.acid,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()
# Distribution of volatile.acidity
summary(red_wine$volatile.acidity)

volatile_acidity_h <-ggplot(aes(x=volatile.acidity,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of volatile.acidity
summary(red_wine$volatile.acidity)

volatile_acidity_h <-ggplot(aes(x=volatile.acidity,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

#Distribution of residual.sugar
summary(red_wine$residual.sugar)

residual_sugar_h <-ggplot(aes(x=residual.sugar,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of chlorides
#it shows one peak at 0.08. and it has an outliers 
summary(red_wine$chlorides)

chlorides_h <-ggplot(aes(x=chlorides,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of free.sulfur.dioxide
summary(red_wine$free.sulfur.dioxide)

free_sulfur_dioxide_h <-ggplot(aes(x=free.sulfur.dioxide,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of density

summary(red_wine$density)

density_h<-ggplot(aes(x=density,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()


# Distribution of total.sulfur.dioxide
summary(red_wine$total.sulfur.dioxide)

total_sulfur_dioxide_h<-ggplot(aes(x=total.sulfur.dioxide,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of pH

summary(red_wine$pH)

pH_h <-ggplot(aes(x=pH,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of sulphates 
summary(red_wine$sulphates)

sulphates_h<-ggplot(aes(x=sulphates,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of alcohol
#it shows that it has a peak value around 9.4. and it has an outliers 
summary(red_wine$alcohol)

alcohol_h<-ggplot(aes(x=alcohol,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of quality
summary(red_wine$quality)

quality_h<-ggplot(aes(x=quality,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram(stat="count")

# Distribution of rating
summary(red_wine$rating)

rating_h<-ggplot(aes(x=rating,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram( stat = "count")
rating_h

```
To understand the data more, and have a look at the type of distribution and outliers, graphs are visualized to demonstrate statistical information.
```{r, error=TRUE}


# Distribution of fixed.acidity variable.

#it shows that there is one peak at 7 in the histogram plot.and it has outliers

summary(red_wine$fixed.acidity)

fixed_acidity_h<-ggplot(aes(x=fixed.acidity,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()
fixed_acidity_h

# Distribution of citric acid variable
#it shows that there are two peaks at 0 and 0.49 in the histogram plot.and it has outliers
#we can see that citric.acid has an outlier 
summary(red_wine$citric.acid)

citric_acid_h <-ggplot(aes(x=citric.acid,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()


# Distribution of volatile.acidity
#it shows that there are two peaks at 0.6 and 0.4 in the histogram plot.and it has outliers
summary(red_wine$volatile.acidity)

volatile_acidity_h <-ggplot(aes(x=volatile.acidity,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()
 


#Distribution of residual.sugar
#it shows one peak at 2. and it has an outliers 
summary(red_wine$residual.sugar)

residual_sugar_h <-ggplot(aes(x=residual.sugar,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()


# Distribution of chlorides
#it shows one peak at 0.08. and it has an outliers 
summary(red_wine$chlorides)

chlorides_h <-ggplot(aes(x=chlorides,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()
 


# Distribution of free.sulfur.dioxide
#it shows one peak at 5. and it has an outliers and it shows a normal distribution
summary(red_wine$free.sulfur.dioxide)

free_sulfur_dioxide_h <-ggplot(aes(x=free.sulfur.dioxide,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()
 


# Distribution of density
#it shows one peak at #it shows one peak at 0.99. and it has an outliers 
#The summary results shows that the mean and median values
#are pretty close which means we have a normal distribution .
summary(red_wine$density)

density_h<-ggplot(aes(x=density,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()


# Distribution of total.sulfur.dioxide
#it shows that it has a peak value around 20. and it has an outliers 
summary(red_wine$total.sulfur.dioxide)

total_sulfur_dioxide_h<-ggplot(aes(x=total.sulfur.dioxide,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()



# Distribution of pH
#The summary results shows that the mean and median values 
#are pretty close which means we have a normal distribution .
summary(red_wine$pH)

pH_h <-ggplot(aes(x=pH,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()


# Distribution of sulphates 
#it shows that it has a peak value around 0.6.and it has an outliers 
summary(red_wine$sulphates)

sulphates_h<-ggplot(aes(x=sulphates,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

sulphates_h

# Distribution of alcohol
#it shows that it has a peak value around 9.4. and it has an outliers 
summary(red_wine$alcohol)

alcohol_h<-ggplot(aes(x=alcohol,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram()

# Distribution of quality
#it shows that there are two peaks at 5 and 6 in the histogram plot.
summary(red_wine$quality)

quality_h<-ggplot(aes(x=quality,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram(stat="count")

# Distribution of rating
#the distribution shows that most of the wines falls under the average wine quality. 
summary(red_wine$rating)

rating_h<-ggplot(aes(x=rating,color = I('black'),fill=I('lightblue')), data = red_wine ) +
  geom_histogram( stat = "count")
rating_h
#now use grid.arrange function
grid.arrange(fixed_acidity_h,volatile_acidity_h,citric_acid_h,
             residual_sugar_h,chlorides_h,free_sulfur_dioxide_h,
             total_sulfur_dioxide_h,density_h,pH_h,
             alcohol_h,ncol=2 ,bottom = "Variables Distributions ")

```
It shows that most of the variables are positively skewed to the left with outliers . except two variables showing a normal distributions which are pH and density).

we can use the aggregate function for the data set and group it 
by “rating” by computing the mean for each group 
```{r}


agg_mean<-aggregate(red_wine[,1:12],by=list(red_wine$rating),FUN=mean, na.rm=TRUE)
agg_mean

```

#### Correlation: 

Now we compare alchool with the rest of variables based on the ratings to see which variable is compatible with alchool that gives a good wine quality and interpret only the good rating.

#####fixed.acidity:



